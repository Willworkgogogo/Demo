require.config({paths:{echarts:"static/js/echarts/build/dist"}}),require(["echarts","echarts/chart/map"],function(t){$(document).ready(function(i){function n(){i(".smm_map_content_listUl").on("click",function(t){if(i(t.target).is(":checked")){var n={},e="";n.id=i(t.target).parent().parent().attr("hello"),n.name=i(t.target).parent().siblings(".list_third").find(".listItems_subwrap div").text(),e=i(t.target).parent().parent().prop("outerHTML"),n.ul=e,quantity=i(t.target).parent().siblings(".list_seventh").text(),n.quantity=Number(quantity)?Number(quantity):0,capcity=i(t.target).parent().siblings(".list_eighth").text(),n.capcity=Number(capcity)?Number(capcity):0,console.log(n),w.push(n),1==C&&(i(".smm_map_rightCompare").stop(!0,!0).animate({left:0},500,function(){i(".rightButtonToggle").css("background","url(./static/img/button_arrow.png) -12px 0 no-repeat")}),C=2)}else{for(var a=0;a<w.length;a++)w[a].id==i(t.target).parent().parent().attr("hello")&&w.splice(a,1);2==C&&0==w.length&&(i(".smm_map_rightCompare").stop(!0,!0).animate({left:162},500,function(){i(".rightButtonToggle").css("background","url(./static/img/button_arrow.png) no-repeat")}),C=1)}l(),s()})}function e(t){y.dataRange.max=t.max,y.series[0].data=t.data,b.setOption(y)}function a(t){for(var e="",a=0;a<t.data.length;a++)0==t.data[a].company_info.security_status?t.data[a].company_info.security_status="未上市":""==t.data[a].company_info.mine_info?t.data[a].company_info.mine_info="-":null==t.data[a].product_infos[0].quantity&&(t.data[a].product_infos[0].quantity="N/A"),e+='<ul class="smm_map_content_listUl" hello="'+t.data[a].company_info.id+'"><li class="list_first"><input type="checkbox" name=""></li><li class="list_second"><div><p>'+t.data[a].company_info.province+"</p><p>"+t.data[a].company_info.city+'</p></div></li><li class="list_third"><div class="listItems_subwrap"><div>'+t.data[a].company_info.name+'</div></div></li><li class="list_fourth"><div class="listItems_subwrap"><div>'+t.data[a].company_info.address+'</div></div></li><li class="list_fifth"><div class="listItems_subwrap"><div><p>'+t.data[a].company_info.security_status+"</p><p>"+t.data[a].company_info.security_code+'</p></div></div></li><li class="list_sixth"><div class="listItems_subwrap"><div>'+t.data[a].company_info.mine_info+'</div></div></li><li class="list_seventh">'+(t.data[a].product_infos[0].quantity?t.data[a].product_infos[0].quantity:"N/A")+'</li><li class="list_seventh_next"><div class="listItems_subwrap"><div>'+(t.data[a].product_infos[0].additional_info?t.data[a].product_infos[0].additional_info:"N/A")+'</div></div></li><li class="list_eighth"><span>'+(t.data[a].product_infos[1].quantity?t.data[a].product_infos[1].quantity:"N/A")+'</span></li><li class="list_eighth_next"><div class="listItems_subwrap"><div>'+(t.data[a].product_infos[1].additional_info?t.data[a].product_infos[1].additional_info:"N/A")+'</div></div></li><li class="list_ninth"><span>'+(t.data[a].product_infos[2].additional_info?t.data[a].product_infos[2].additional_info:"N/A")+'</span></li><li class="list_ten"><div class="listItems_subwrap"><div>'+(t.data[a].product_infos[3].additional_info?t.data[a].product_infos[3].additional_info:"N/A")+"</div></div></li></ul>";i(".smm_map_content_innerWrap").html(e),n(),m(),d(20),g()}function s(){if(w!=[])for(var t=0;t<w.length;t++)i(".smm_map_rightCompare_innerWrap").find(".rightCompare_listItems").eq(t).html('<div class="rightCompare_listItems_content">'+w[t].name+'</div><div class="rightCompare_btnDelete"><button>删除</button></div>');for(var t=w.length;t<5;t++)i(".smm_map_rightCompare_innerWrap").find(".rightCompare_listItems").eq(t).html('<img src="'+x[t]+'">')}function o(){if(0==w.length)i(".smm_map_content_listUl").each(function(){i(this).find(".list_first input").removeAttr("checked")});else for(var t=0;t<w.length;t++)i(".smm_map_content_listUl").each(function(){i(this).attr("hello")==w[t].id?i(this).find(".list_first input").attr("checked"):i(this).find(".list_first input").removeAttr("checked")})}function c(){for(var t="",n=0;n<w.length;n++)t+=w[n].ul;i(".listCompare_content").html(t),i(".listCompare_content .list_first").remove()}function r(t){return function(i,n){var e=i[t],a=n[t];return e-a}}function l(){var t=i(".smm_map_content_innerWrap .list_first input");w.length>=5?t.each(function(){i(this)[0].checked||i(this).attr("disabled","disabled")}):t.each(function(){i(this).removeAttr("disabled")})}function m(){i(".smm_map_content_listUl:even").css("background","#fff"),i(".smm_map_content_listUl:odd").css("background","#fafafa")}function p(){i(".listCompare_content .smm_map_content_listUl:even").css("background","#fff"),i(".listCompare_content .smm_map_content_listUl:odd").css("background","#fafafa")}function _(){i(".paginationWrap").createPage({pageCount:5,current:1,backFn:function(t){console.log(t)}})}function d(t){i(".paginationWrap").createPage({pageCount:t,current:1})}function u(t){var i=document.createElement("div");i.className="loadState",i.innerHTML="&nbsp;&nbsp;&nbsp;&nbsp;加载中...",t.append(i)}function f(){i(".loadState").remove()}function g(){var t=i(".smm_map_content_listUl .list_seventh_next"),n=i(".smm_map_content_listUl .list_eighth_next");t.each(function(){i(this).on({mouseover:function(){h(i(this)),i(this).find(".tipBox").stop().show(),i(".tipBox").on("mouseover",function(t){t.stopPropagation()})},mouseout:function(){i(this).find(".tipBox").stop().css({display:"none"},function(){i(this).remove()})}})}),n.each(function(){i(this).on({mouseover:function(){h(i(this)),i(this).find(".tipBox").stop().show(),i(".tipBox").on("mouseover",function(t){t.stopPropagation()})},mouseout:function(){i(this).find(".tipBox").stop().css({display:"none"},function(){i(this).remove()})}})})}function h(t){var n=document.createElement("div"),e=document.createElement("em"),a=document.createElement("span");n.className="tipBox",i(n).text(t.children(".listItems_subwrap").find("div").text()),e.innerHTML="&#9670;",a.innerHTML="&#9670;",i(e).appendTo(n),i(a).appendTo(n),i(n).appendTo(t)}var v={selectedCatagory:"",selectedProvince:"",$map_subnav_title_li:i(".map_subnav_title>li"),$map_subnav_title_subnav_li:i(".map_subnav_title_subnav").find("li"),$listItem_info:i(".listItem_info"),$listItem_compare:i(".listItem_compare"),$listInfo_wrap:i(".listInfo_wrap"),$listCompare_wrap:i(".listCompare_wrap"),$smm_map_rightCompare:i(".smm_map_rightCompare"),$smm_map_listTitle_listFirst:i(".smm_map_listTitle .list_first"),$smm_map_content_innerWrap:i(".smm_map_content_innerWrap"),$smm_map_content_listUl:i(".smm_map_content_listUl"),$contentInput:i(".smm_map_content_innerWrap .list_first input"),rightBtn:i(".rightButtonToggle"),listInfo_output:i(".listInfo_sortBtnBox1"),listInfo_capacity:i(".listInfo_sortBtnBox2")};v.$map_subnav_title_li.on({mouseover:function(){i(this).children("ul").css({display:"block",width:i(this).innerWidth()-1+"px"})},mouseout:function(){i(this).children("ul").css({display:"none"})}});var b=t.init(document.getElementById("smm_map_echarts")),y={tooltip:{trigger:"item"},dataRange:{min:0,max:1e3,x:"left",y:"bottom",text:["高","低"],calculable:!0},toolbox:{show:!0,orient:"vertical",x:"right",y:"center",feature:{dataView:{show:!0,readOnly:!1},restore:{show:!0},saveAsImage:{show:!0}}},roamController:{show:!0,x:"right",mapTypeControl:{china:!0}},series:[{name:"tong",type:"map",mapType:"china",roam:!1,itemStyle:{normal:{label:{show:!0}},emphasis:{label:{show:!0}}},data:[]}]};b.setOption(y),i.ajax({url:"static/js/test4.json",type:"GET",beforeSend:function(){u(i(".listInfo_wrap"))},success:function(t){a(t)},error:function(t,i,n){console.log(n)},complete:function(){f()}}),i.ajax({url:"static/js/test.json",type:"GET",beforeSend:function(){b.showLoading()},success:function(t){e(t)},error:function(t,i,n){console.log(n)},complete:function(){b.hideLoading()}}),i(".map_subnav_title").on("click",function(t){i(t.target).is("span")&&(v.selectedCatagory=i(t.target).text(),i.ajax({url:"catagory/"+v.selectedCatagory,type:"GET",beforeSend:function(){b.showLoading(),u(i(".listInfo_wrap"))},success:function(t){e(t),a(t)},complete:function(){b.hideLoading(),f()}}))}),i(".map_subnav_title_subnav").on("click",function(t){t.stopPropagation(),i(t.target).is("li")&&(v.selectedCatagory=i(t.target).text(),console.log(v.selectedCatagory),i.ajax({url:"catagory/map"+i(t.target).text(),type:"GET",beforeSend:function(){b.showLoading(),u(i(".listInfo_wrap"))},success:function(t){e(t),a(t)},complete:function(){b.hideLoading(),f()}}))}),i(".map_subnav_tips").on("click",function(t){i(t.target).is("li")&&(v.selectedCatagory=i(t.target).text(),i.ajax({url:"catagory/map"+i(t.target).text(),type:"GET",beforeSend:function(){b.showLoading(),u(i(".listInfo_wrap"))},success:function(t){e(t),a(t)},complete:function(){b.hideLoading(),f()}}))}),b.on("click",function(t){v.selectedProvince=t.name,i.ajax({url:"catagory/map"+v.selectedCatagory+t.name,type:"GET",success:function(t){a(t)}})}),v.$listItem_info.on("click",function(){v.$smm_map_listTitle_listFirst.css("display","block"),v.$listInfo_wrap.css("display","block"),v.$listCompare_wrap.css("display","none"),i(this).addClass("listItem_selected"),v.$listItem_compare.removeClass("listItem_selected")}),v.$listItem_compare.on("click",function(){v.$smm_map_listTitle_listFirst.css("display","none"),v.$listInfo_wrap.css("display","none"),v.$listCompare_wrap.css("display","block"),i(this).addClass("listItem_selected"),v.$listItem_info.removeClass("listItem_selected")}),i(".rightCompare_wrap").css({top:i(".smm_map_listItem").offset().top+"px",display:"block"}),i(".rightCompare_toggle").on("click",function(){v.$smm_map_rightCompare.fadeOut("fast")});var C=1;i(".rightButtonToggle").on("click",function(){1==C?(v.$smm_map_rightCompare.stop(!0,!0).animate({left:0},500,function(){v.rightBtn.css("background","url(./static/img/button_arrow.png) -12px 0 no-repeat")}),C=2):(v.$smm_map_rightCompare.stop(!0,!0).animate({left:162},500,function(){v.rightBtn.css("background","url(./static/img/button_arrow.png) no-repeat")}),C=1)});var w=[],x=["static/img/compare1.png","static/img/compare2.png","static/img/compare3.png","static/img/compare4.png","static/img/compare5.png"];v.$contentInput.each(function(t,n){i(this).removeAttr("checked")}),m(),i(".smm_map_rightCompare_innerWrap").on("click",function(t){if("删除"==i(t.target).text()){for(var n=0;n<w.length;n++)w[n].name==i(t.target).parent().siblings(".rightCompare_listItems_content").text()&&(i(".smm_map_content_listUl").each(function(){i(this).attr("hello")==w[n].id&&i(this).find(".list_first input").removeAttr("checked")}),w.splice(n,1));2==C&&0==w.length&&(v.$smm_map_rightCompare.stop(!0,!0).animate({left:162},500,function(){v.rightBtn.css("background","url(./static/img/button_arrow.png) no-repeat")}),C=1),s(),c(),p()}"对比"==i(t.target).text()&&(v.$smm_map_listTitle_listFirst.css("display","none"),v.$listInfo_wrap.css("display","none"),v.$listCompare_wrap.css("display","block"),v.$listItem_compare.addClass("listItem_selected"),v.$listItem_info.removeClass("listItem_selected"),c(),p(),g()),"清空对比栏"==i(t.target).text()&&(w=[],s(),o(),c(),2==C&&0==w.length&&(v.$smm_map_rightCompare.stop(!0,!0).animate({left:162},500,function(){v.rightBtn.css("background","url(./static/img/button_arrow.png) no-repeat")}),C=1)),l()}),i(".rightCompare_hide").on("click",function(){v.$smm_map_rightCompare.stop(!0,!0).animate({left:162},500,function(){v.rightBtn.css("background","url(./static/img/button_arrow.png) no-repeat")}),C=1}),n(),i("#listCompare_seven_btnTop").on("click",function(t){w.sort(r("quantity")),c()}),i("#listCompare_seven_btnDown").on("click",function(t){w.sort(r("quantity")).reverse(),c()}),i("#listCompare_eight_btnTop").on("click",function(t){console.log(3),w.sort(r("capcity")),c()}),i("#listCompare_eight_btnDown").on("click",function(t){console.log(4),w.sort(r("quantity")).reverse(),c()}),_()})});